# synchronized关键字
保证同一时刻只允许一条线程操作   
锁定当前对象synchronized(this)
可重入锁：一个同步方法可以调用另一个同步方法。一个线程已经拥有某个对象的锁，再次申请时仍然会得到该对象的锁。锁定的对象都是一个。
## 1）synchronized 方法
由于 java 的每个对象都有一个内置锁，当用synchronized此关键字修饰方法时， 内置锁会保护整个方法。在调用该方法前，需要获得内置锁，否则就处于阻塞状态。而方法一旦开始执行，就会独占该锁，直到方法执行完成返回后释放该锁，然后阻塞的线程就获取锁，然后调用方法执行。

注：synchronized 关键字也可以修饰静态方法，此时如果调用该静态方法，将会锁住整个类。   
缺点：将方法声明为synchronized会影响效率。例如，如果我们想线程类的run()
方法定义为synchronized的，则在线程的整个生命周期内，它都会一直运行，且它无法调用本类任何synchronized方法，因为一直占用锁。所以我们可以将访问成员变量部分的代码定义为单独的方法，然后将这个方法声明为synchronized即可。

## 2）synchronized 块
可以对任意代码块声明为 synchronized，灵活性较高。根据实际的需要对于想要添加锁的代码或类加锁。

### synchronized(T.class)
static没有this对象
public synchronized static void m() 等同于synchronized(T.class)

# 锁
程序执行异常，锁释放
## 锁升级
原先：synchronized去找操作系统，要找内核申请锁。
偏向锁：第一个访问某把锁的线程内部实现时，仅记录这个线程的ID.   
自旋锁: 如有线程争用的话，就升级为自旋锁。    
重量级锁：自旋锁转圈10次后，升级为重量级锁，去操作系统中申请资源。
#####锁区分
执行时间短（加锁代码），线程数少，用自旋；   
执行时间长，线程数多，用系统锁。